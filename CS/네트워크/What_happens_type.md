# μ›Ή ν†µμ‹ μ νλ¦„
> `www.google.com`λ¥Ό μ£Όμ†μ°½μ— μΉλ©΄ λ¬΄μ¨ μΌμ΄ μΌμ–΄λ‚ κΉ?
___
## 1. λΈλΌμ°μ € URL νμ‹±

![img](https://user-images.githubusercontent.com/75003424/124287483-0671f200-db8b-11eb-9498-e17442d62bb7.png)

μ…λ ¥λ°›μ€ URLμ κµ¬μ΅°λ¥Ό ν•΄μ„ν•λ‹¤.
* μ–΄λ–¤ **ν”„λ΅ν† μ½**μ„ ν†µν•΄ URLμ„ μ”μ²­ν•  κ²ƒμΈμ§€,
* μ–΄λ–¤ **URL**λ΅ μ”μ²­ν•  κ²ƒμΈμ§€
* μ–΄λ–¤ **ν¬νΈ**λ΅ μ”μ²­ν•  κ²ƒμΈμ§€ -> HTTP = 80 ν¬νΈ , HTTPS = 443 ν¬νΈλ¥Ό λ””ν΄νΈλ΅ ν•λ‹¤.

## 2. HSTS λ©λ΅ μ΅°ν 
_HSTS(HTTP Strict transport security)_ :  HTTPλ¥Ό ν—μ©ν•μ§€ μ•κ³  `HTTPS`λ¥Ό μ‚¬μ©ν•λ” μ—°κ²°λ§ ν—μ©ν•λ” κΈ°λ¥μ΄λ‹¤.

* λΈλΌμ°μ €λ” HTTPSλ΅λ§ μ—°κ²°λλ„λ΅ μ”μ²­ν• μ›Ήμ‚¬μ΄νΈμ λ©λ΅μΈ HSTS (HTTP Strict Transport Security)" λ¦¬μ¤νΈλ¥Ό λ―Έλ¦¬ μ¤€λΉ„ν•κ³ , μ”μ²­μ΄ λ“¤μ–΄μ¤λ©΄ μ΄ λ¦¬μ¤νΈμ•μ— μλ”μ§€ ν™•μΈν•λ‹¤
* HSTSλ©λ΅μ— μ΅΄μ¬ν•λ‹¤λ©΄, λΈλΌμ°μ €λ” μ”μ²­μ„ HTTP λ€μ‹  HTTPSλ΅ λ³΄λ‚Έλ‹¤(HTTPλ΅ μ”μ²­ν•΄λ„ HTTPSλ°ν™)

## 3. URLμ„ IPμ£Όμ†λ΅ λ³€ν™
μ»΄ν“¨ν„°λΌλ¦¬λ” www.google.com μ΄λΌλ” μ£Όμ†λ΅ ν†µμ‹ ν•  μ μ—†λ‹¤. <br>
μ΄ μ£Όμ†λ¥Ό μ»΄ν“¨ν„°κ°€ μ½μ„ μ μλ„λ΅ **IPμ£Όμ†λ΅ λ³€ν™**ν•΄μ•Ό ν†µμ‹ μ΄ κ°€λ¥ν•λ‹¤.

λ„λ©”μΈ μ£Όμ†λ¥Ό IPμ£Όμ†λ΅ λ³€ν™ν•΄μ£Όλ” `DNS (Domain Name System)μ„λ²„`μ— μ”μ³¥ν•μ—¬ ν•΄λ‹Ή URLμ„ IPμ£Όμ†λ΅ λ³€ν™ν•λ‹¤.

> **IPλ€?** <br>
μΈν„°λ„·μ— μ—°κ²°λμ–΄ μλ” μ¥μΉ(μ»΄ν“¨ν„°, μ¤λ§νΈν°, νƒ€λΈ”λ¦Ώ, μ„λ²„ λ“±λ“±)λ“¤μ΄ μ„λ΅ μΈμ‹ν•κ³  ν†µμ‹ μ„ ν•κΈ°μ„ν•΄ μ΅΄μ¬ν•λ” κ³ μ ν• μ£Όμ† <br>
μ) 115.68.24.88, 192.168.0.1

> **λ„λ©”μΈ(domain)μ΄λ€?**<br>
ipλ” μ‚¬λμ΄ μ΄ν•΄ν•κ³  κΈ°μ–µν•κΈ° μ–΄λ µκΈ° λ•λ¬Έμ— μ΄λ¥Ό μ„ν•΄μ„ κ° ipμ— μ΄λ¦„μ„ λ¶€μ—¬ν•  μ μκ² ν–λ”λ°, μ΄κ²ƒμ„ λ„λ©”μΈμ΄λΌκ³  ν•λ‹¤.

λΈλΌμ°μ €λ” μ΄λ• HTTP Request Messageλ¥Ό λ§λ“ λ‹¤. 

## 4. λΌμ°ν„°λ¥Ό ν†µν•΄ ν•΄λ‹Ή μ„λ²„μ κ²μ΄νΈμ›¨μ΄κΉμ§€ μ΄λ™ν•λ‹¤.
λ„¤νΈμ›ν¬ μ¥λΉ„μΈ **λΌμ°ν„°**μ λΌμ°ν…μ„ μ΄μ©ν•΄ μ΄λ£¨μ–΄μ§

## 5. ARPλ¥Ό ν†µν•΄ IPμ£Όμ†λ¥Ό MACμ£Όμ†λ΅ λ³€ν™
μ‹¤μ§μ μΈ ν†µμ‹ μ„ ν•κΈ° μ„ν•΄μ„λ” λ…Όλ¦¬ μ£Όμ†μΈ IPμ£Όμ†λ¥Ό λ¬Όλ¦¬ μ£Όμ†μΈ `MACμ£Όμ†`λ΅ λ³€ν™ν•΄μ•Ό ν•λ‹¤.

μ΄λ¥Ό μ„ν•΄ ν•΄λ‹Ή λ„¤νΈμ›ν¬ λ‚΄μ—μ„ **ARP**λ¥Ό `λΈλ΅λ“ μΊμ¤ν…`ν•λ”λ°,
ν•΄λ‹Ή IPμ£Όμ†λ¥Ό κ°€μ§€κ³  μλ” λ…Έλ“λ” μμ‹ μ MAC μ£Όμ†λ¥Ό μ‘λ‹µν•©λ‹λ‹¤.

> **ARP (Address Resolution Protocol)**
    ν•΄λ‹Ή IPλ¥Ό κ·Έ IPμ£Όμ†μ— λ§λ” λ¬Όλ¦¬μ μΈ μ£Όμ† μ¦‰, MACμ£Όμ†λ¥Ό κ°€μ§€κ³  μ¤λ” ν”„λ΅ν† μ½μ΄λ‹¤.

> **λΈλ΅λ“μΊμ¤ν…(broadcasting)**
    μ†΅μ‹  νΈμ¤νΈκ°€ μ „μ†΅ν• λ°μ΄ν„°κ°€ λ„¤νΈμ›ν¬μ— μ—°κ²°λ λ¨λ“  νΈμ¤νΈμ— μ „μ†΅λλ” λ°©μ‹μ„ μλ―Έν•λ‹¤.
    ![img](https://upload.wikimedia.org/wikipedia/commons/thumb/d/dc/Broadcast.svg/250px-Broadcast.svg.png)

## 6. λ€μƒ μ„λ²„μ™€ TCP μ†μΌ“ μ—°κ²°
μ΄μ  λ€μƒ μ„λ²„μ™€ ν†µμ‹ ν•κΈ° μ„ν•΄ `TCP μ†μΌ“ μ—°κ²°`μ„ μ§„ν–‰ν•λ‹¤<br>
μ†μΌ“ μ—°κ²°μ€ `3-way-handshake`λΌλ” κ³Όμ •μ„ ν†µν•΄ μ΄λ£¨μ–΄μ§„λ‹¤<br>


### π‘‰ 3-way-handshake
<img src="https://feel5ny.github.io/images/2018/01/handshake.jpg">

1. μ—°κ²°μ„ ν•κΈ° μ „ :  ν΄λΌμ΄μ–ΈνΈλ” Closed μƒνƒμ΄κ³ , μ„λ²„λ” μ”μ²­μ„ κΈ°λ‹¤λ¦¬κ³  μλ” LISTEN μƒνƒ
2. ν΄λΌμ΄μ–ΈνΈμ— --> μ„λ²„ : μ—°κ²°μ„ μ”μ²­ν•λ” **SYN** λ°μ΄ν„°λ¥Ό μ „μ†΅
3. μ„λ²„ --> ν΄λΌμ΄μ–ΈνΈ : μ„λ²„κ°€ SYNμ„ λ°›μΌλ©΄ κ·Έ μ‘λ‹µμΌλ΅, ν΄λΌμ΄μ–ΈνΈμ—κ² λ°›μ•λ SYNμ— ACKλ°μ΄ν„°λ¥Ό μ¶”κ°€ν•΄ λ°μ΄ν„°λ¥Ό λ³΄λ‚Έλ‹¤. ν΄λΌμ΄μ–ΈνΈμ—κ² "μλ°›μ•μΌλ‹ ν¬νΈ μ—΄μ–΄λ‹¬λΌλ” μ‹ νΈλ³΄λƒ„"<br> 
(λ™μ‹μ— μ„λ²„λ” `LISTEN μƒνƒ`μ—μ„ μƒλ€λ°©μ μ‘λ‹µμ„ κΈ°λ‹¤λ¦¬λ” `SYN_RCV μƒνƒ`λ΅ λ³€κ²½λ¨)
4. ν΄λΌμ΄μ–ΈνΈμ— --> μ„λ²„ : μ„λ²„λ΅λ¶€ν„° ACK + SYN λ°μ΄ν„°λ¥Ό λ°›μΌλ©΄, ν΄λΌμ΄μ–ΈνΈλ” **ν¬νΈλ¥Ό μ—΄κ³ ** μ΄μ— λ€ν• ν™•μΈμΌλ΅ μ„λ²„μ— ACK λ°μ΄ν„°λ¥Ό λ³΄λƒ„<br> (κ·Έλ¬λ©΄μ„ ν΄λΌμ΄μ–ΈνΈλ” `Closed μƒνƒ`μ—μ„ `ESTABLISHED μƒνƒ`λ΅ λ°”λ€
5. μ„λ²„ : ACK λ°μ΄ν„°λ¥Ό λ°›μ€ μ„λ²„λ„ `ESTBALISHED μƒνƒ`λ΅ λ³€κ²½λλ©΄μ„, ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„λ” μ—°κ²°μ΄ λ¨

> **HTTPS μ”μ²­μ κ²½μ° μ•”νΈν™” ν†µμ‹ μ— ν•„μ”ν• κ³Όμ •(TLS ν•Έλ“μ‰μ΄ν‚Ή)μ΄ μ¶”κ°€λλ‹¤**
### π‘‰ TLS-handshake
TLS(Transport Layer Security)λ” HTTP λ°©μ‹ λΏλ§μ•„λ‹λΌ TCPν†µμ‹ μ„ ν•λ” FTPκ°™μ€ ν”„λ΅ν† μ½μ—λ„ μ μ©λ  μ μλ‹¤.
1.  ν΄λΌμ΄μ–ΈνΈ --> μ„λ²„ : ν΄λΌμ΄μ–ΈνΈλ” **TLSλ²„μ „, μ•”νΈ μ•κ³ λ¦¬μ¦ λ©λ΅ κ·Έλ¦¬κ³  μ‚¬μ© κ°€λ¥ν• μ••μ¶• λ°©μ‹**μ„ `ClientHello λ©”μ‹μ§€`μ— λ‹΄μ•„ μ„λ²„λ΅ μ „μ†΅
2. μ„λ²„ --> ν΄λΌμ΄μ–ΈνΈ : μ„λ²„λ” ν΄λΌμ΄μ–ΈνΈμ—κ² **TLS λ²„μ „, μ„ νƒν• μ•”νΈ μ•κ³ λ¦¬μ¦, μ„ νƒν• μ••μ¶• λ°©μ‹ κ·Έλ¦¬κ³  CA (Certificate Authority) κ°€ μ‚¬μΈν• μ„λ²„μ κ³µκ° μΈμ¦μ„**λ¥Ό `ServerHello λ©”μ‹μ§€`μ— λ‹΄μ•„ λ‹µμ¥ν•λ‹¤.<br>
(μΈμ¦μ„μ—λ” λ€μΉ­ν‚¤κ°€ μƒμ„±λκΈ° μ „κΉμ§€ handshake κ³Όμ •μ„ μ•”νΈν™”ν•λ” λ°μ— μ“Έ κ³µκ°ν‚¤κ°€ λ“¤μ–΄μμ)
3. ν΄λΌμ΄μ–ΈνΈ : μ„λ²„κ°€ λ³΄λ‚Έ μΈμ¦μ„κ°€ μ ν¨ν•μ§€λ¥Ό, μ‹ λΆ°ν•  μ μλ” CA λ©λ΅μ„ ν†µν•΄ ν™•μΈν•λ‹¤. CAλ¥Ό ν†µν•΄ μ‹ λΆ°μ„±μ΄ ν™•λ³΄λλ©΄, ν΄λΌμ΄μ–ΈνΈλ” μμ‚¬ λ‚μ λ°”μ΄νΈλ¥Ό μƒμ„±ν•κ³ , μ΄ λ‚μλ¥Ό μ„λ²„μ κ³µκ°ν‚¤λ΅ **μ•”νΈν™”**ν•λ‹¤.<br>
(λ‚μ λ°”μ΄νΈλ” λ€μΉ­ν‚¤λ¥Ό μ •ν•  λ• μ‚¬μ©)
4. μ„λ²„ : λ°›μ€ λ‚μ λ°”μ΄νΈλ¥Ό μκΈ° κ°μΈν‚¤λ΅ **λ³µνΈν™”**ν•΄ λ€μΉ­ λ§μ¤ν„°ν‚¤ μƒμ„±μ— ν™μ©
5. ν΄λΌμ΄μ–ΈνΈ : `Finished λ©”μ‹μ§€`λ¥Ό μ„λ²„λ΅ λ³΄λ‚΄κ³ , μ§€κΈκΉμ§€μ κµν™ λ‚΄μ—­μ„ ν•΄μ‹ν• κ°’μ„ λ€μΉ­ν‚¤λ΅ μ•”νΈν™”ν•μ—¬ λ‹΄λ”λ‹¤
6. μ„λ²„ :  μ¤μ¤λ΅λ„ ν•΄μ‹λ¥Ό μƒμ„±ν•΄ ν΄λΌμ΄μ–ΈνΈμ—μ„ λ„μ°©ν• κ°’κ³Ό μΌμΉν•λ”μ§€ ν™•μΈν•κ³ , μΌμΉν•λ©΄, μ„λ²„λ„ ν΄λΌμ΄μ–ΈνΈμ™€ λ™μΌν•κ² λ€μΉ­ν‚¤λ¥Ό ν†µν•΄ μ•”νΈν™”ν• `Finished λ©”μ‹μ§€`λ¥Ό ν΄λΌμ΄μ–ΈνΈμ— μ „μ†΅ν•λ‹¤.
7. μ΄μ  TLS μ„Έμ…μ΄ λ€μΉ­ν‚¤λ΅ μ•”νΈν™”λ μ–΄ν”λ¦¬μΌ€μ΄μ… (HTTP) λ°μ΄ν„°λ¥Ό μ „μ†΅ν• μ μκ² λλ‹¤

### π‘‰ Httpsμ”μ²­μ μ†μΌ“ μ—°κ²° κ³Όμ •
<img width="471" alt="α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2022-09-08 α„‹α…©α„’α…® 7 51 08" src="https://user-images.githubusercontent.com/71719160/189104232-1d8a01d6-c17b-46c3-b884-27b13f027f76.png">

## 7. HTTP(HTTPS) ν”„λ΅ν† μ½λ΅ μ”μ²­, μ‘λ‹µ
μ΄μ  μ—°κ²°μ΄ ν™•μ •λμ—μΌλ‹ λ“λ””μ–΄ ν•΄λ‹Ή νμ΄μ§€ www.google.comλ¥Ό λ‹¬λΌκ³  μ„λ²„μ—κ² μ”μ²­μ„ λ³΄λƒ„

μ”μ²­μ„ λ°›μ€ μ„λ²„λ” μλ½ν•  μ μλ” μ”μ²­μΈμ§€ κ²€μ‚¬ν•κ³ , μ΄ μ”μ²­μ— λ€ν• μ‘λ‹µμ„ μƒμ„±ν•μ—¬ λΈλΌμ°μ €μ—κ² μ „λ‹¬

## 8. λΈλΌμ°μ €μ—μ„ μ‘λ‹µμ„ ν•΄μ„ν•λ‹¤.
μ΄λ¥Ό λΈλΌμ°μ €μ—μ„ ν•΄μ„ν•μ—¬ ν™”λ©΄μ— λ³΄μ—¬μ¤

## κ°„λ‹¨ν•κ² μ”μ•½ν•΄λ³΄λ©΄?

> URL νμ‹± <br>
 β†’ λ„λ©”μΈ μ£Όμ†λ¥Ό IPμ£Όμ†λ΅ λ³€ν™ (DNS μ„λ²„μ— μ”μ²­μ„λ³΄λƒ„)<br>
 β†’ λΌμ°ν„°λ¥Ό ν†µν•΄ IPμ£Όμ†λ΅ ν•΄λ‹Ή μ„λ²„ κ²μ΄νΈμ›¨μ΄ κΉμ§€ μ΄λ™ <br>
 β†’ ARP ν”„λ΅ν† μ½λ΅ IPμ£Όμ†λ¥Ό MACμ£Όμ†λ΅ λ³€ν™ <br>
 β†’ λ³€ν™λ MACμ£Όμ†λ¥Ό ν†µν•΄ ν•΄λ‹Ή μ„λ²„μ™€ TCPμ†μΌ“ μ—°κ²° (3-way, TLS) <br>
 β†’ μ—°κ²°μ„ ν™•μ •μ§€μ€ ν›„ μ„λ²„μ— μ”μ²­μ„ λ³΄λƒ„ <br>
 β†’ μ”μ²­μ— λ€ν• μ‘λ‹µμ„ λΈλΌμ°μ €κ°€ ν•΄μ„ν•μ—¬ λλ”λ§ νμ΄μ§€ μ¶λ ¥
